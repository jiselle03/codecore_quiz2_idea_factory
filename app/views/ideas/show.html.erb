<h3>Idea</h3>
<h5><%= @idea.title %></h5>
<p><%= @idea.description %></p>
<p>Added by <%= @idea.user.full_name %> <%= time_ago_in_words(@idea.created_at) %> ago</p>
<p>Last Edited <%= time_ago_in_words(@idea.updated_at) %> ago</p>
<%= link_to("Edit", edit_idea_path(@idea.id)) %> | 
<%= link_to("Delete", idea_path(@idea), method: :delete, data: {confirm: 'Are you sure?'}) %>
<% if @like.present? && can?(:destroy, @like) %>
    <%= link_to(
        "Unlike",
        like_path(@like),
        method: :delete
    ) %>
<% elsif can?(:like, @idea) %>
    <%= link_to(
        "Like",
        idea_likes_path(@idea),
        method: :post
    ) %> | 
<% end %>
<small><%= pluralize(@idea.likes.count, "like") %></small>
<br>

<section>
    <h5>Reviews</h5>

    <%= form_with(model: [@idea, @review], local: true) do |f| %>
        <% if @review.errors.present? %>
        <p class="form-errors">
            <%= @review.errors.full_messages.join(", ") %>
        </p>
        <% end %>

        <div class="form-group">
            <%= f.text_area(
                :body,
                cols: 50,
                rows: 3,
                placeholder: "What do you think about this idea?",
                class: "form-control"
                ) %>
        </div>

        <%= f.submit 'Review' %>

    <% end %>

    <hr>
    <ul class="review-list">
        <% @reviews.each do |review| %>
        <li>
            <%= review.body %> <br>
            <% if can? :crud, review %>
            <small>
                <%= link_to(
                    "Delete",
                    idea_review_path(@idea, review),
                    method: :delete,
                    data: {
                        confirm: "Are you sure?"
                    }
                ) %>
            </small>
            <% end %>
            <small>
                Reviewed by <%= review.user.full_name %> <%= time_ago_in_words(review.created_at) %> ago
            </small>
        </li>
        <% end %>
    </ul>
</section>